import unittest
from exploits.linux.CVE20080600 import CVE20080600
from src.kernelpop import kernelpop
from constants import *


class TestExploitSetup(unittest.TestCase):
	def test_write_exploit_source(self):
		test_exploit = CVE20080600()
		kernelpop(mode="dump", exploit=test_exploit.name, digest=None)
		self.assertTrue(os.path.exists(test_exploit.source_c_path))
		if os.path.exists(test_exploit.source_c_path):
			os.remove(test_exploit.source_c_path)