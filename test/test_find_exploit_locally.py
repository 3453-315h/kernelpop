import unittest
from src.kernelpop import *

from exploits.linux.CVE20177308 import CVE20177308

class TestGetKernelVersion(unittest.TestCase):

	# def potentially_vulnerable(kernel_version, exploit_module):
	def test_new_kernel_not_vulnerable(self):
		test_uname = "Linux atlantic 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_kernel = get_kernel_version(uname=test_uname)
		test_exploit = CVE20177308()
		exploit_results = potentially_vulnerable(test_kernel, test_exploit)
		self.assertEqual(NOT_VULNERABLE, exploit_results)

	def test_new_kernel_no_found_exploits(self):
		test_uname = "Linux atlantic 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_kernel = get_kernel_version(uname=test_uname)
		exploit_results = find_exploit_locally(test_kernel)
		self.assertTrue(total_exploits(exploit_results) == 0)


if __name__ == "__main__":
	unittest.main()
