import unittest
from src.kernelpop import *


class TestGetKernelVersion(unittest.TestCase):

	def test_vulnerable_kernel_matching(self):
		test_uname = "Linux atlantic 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_kernel = get_kernel_version(uname=test_uname)
		exploit_results = find_exploit_locally(test_kernel)
		self.assertTrue(total_exploits(exploit_results) == 0)


if __name__ == "__main__":
	unittest.main()
