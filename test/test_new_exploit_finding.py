import unittest
from src.kernelpop import *
from exploits.linux import CVETEST


class TestNewExploitFinding(unittest.TestCase):
	def test_uname_input(self):
		test_base = "Linux-4.9.0-4-amd64 Debian x86_64 GNU/Linux"
		test_specific = "Linux atlantic 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_specific_2 = "Linux atlantic 4.9.0-4-amd64 #1 SMP Debian 4.9.50-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_exploit = CVETEST.CVETEST()
		test_base_k = get_kernel_version(uname=test_base)
		test_specific_k = get_kernel_version(uname=test_specific)
		test_specific_k_2 = get_kernel_version(uname=test_specific_2)

		find_exploit_locally(test_base_k)
		find_exploit_locally(test_specific_k)
		find_exploit_locally(test_specific_k_2)

		print("run")
		self.assertTrue(True)

	if __name__ == "__main__":
		unittest.main()
