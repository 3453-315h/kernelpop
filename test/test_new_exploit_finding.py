import unittest
from src.kernelpop import *


class TestNewExploitFinding(unittest.TestCase):
	def test_base_k(self):
		# test_exploit = CVETEST.CVETEST()
		test_base = "Linux-4.445.0-4-amd64 Debian x86_64 GNU/Linux"
		test_base_k = get_kernel_version(uname=test_base)
		res = find_exploit_locally(test_base_k)
		self.assertTrue(len(res[BASE_VULNERABLE]) == 1)

	def test_specific_k(self):
		test_specific = "Linux atlantic 4.445.0-4-amd64 #1 SMP Debian 4.445.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_specific_k = get_kernel_version(uname=test_specific)
		find_exploit_locally(test_specific_k)

	def test_specific_k_2(self):
		test_specific = "Linux atlantic 4.445.0-4-amd64 #1 SMP Debian 4.445.66-3+deb9u1 (2017-12-23) x86_64 GNU/Linux"
		test_specific_k = get_kernel_version(uname=test_specific)
		find_exploit_locally(test_specific_k)

	if __name__ == "__main__":
		unittest.main()
